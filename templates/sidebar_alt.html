{% load static %}
<div
id="sidebar_alt"

class="sidebar p-4 bg-red-950 text-white w-full max-w-[300px] min-h-screen fixed shadow-r-lg closed">
  <a
    class="mb-4 flex items-end"
    href="{% url 'home' %}"
  >
  <img class="h-6 xl:h-10 mx-auto xl:mx-0 xl:mr-2" src="{% static 'imgs/logo-w.png' %}" alt="logo" />
  <h1 class="hidden xl:inline text-xl font-black">Dermepro</h1>
  </a>

  <ul class="h-[calc(100vh-70px)] w-full flex flex-col gap-2 mx-auto items-center xl:items-start overflow-y-auto">
    <a
      class="px-1 md:px-3 py-2 text-center xl:text-left rounded-md hover:bg-white hover:text-black transition ease-in duration-200 w-full {{home_page}}"
      href="{% url 'home' %}"
    >
      <i class="text-sm fa-solid fa-house xl:mr-2"></i> 
      
        Accueil
      
    </a>

    <a
      class="px-1 md:px-3 py-2 text-center xl:text-left rounded-md hover:bg-white hover:text-black transition ease-in duration-200 w-full {{visits_page}}"
      href="{% url 'visits' %}"
    >
      <i class="fa-sharp fa-solid fa-user-tie xl:mr-2"></i> 
      
        Visites
      
    </a>
    {% if user.role.sec_level > 1 %}
    <a
      class="px-1 md:px-3 py-2 text-center xl:text-left rounded-md hover:bg-white hover:text-black transition ease-in duration-200 w-full {{rdvs_page}}"
      href="{% url 'appointments' %}"
    >
      <i class="text-sm fa-solid fa-handshake xl:xl:mr-2"></i> 
      
        Rendez-vous
      
    </a>
    {% endif %}
    <a
      class="px-1 md:px-3 py-2 text-center xl:text-left rounded-md hover:bg-white hover:text-black transition ease-in duration-200 w-full {{users_page}}"
      href="{% url 'users' %}"
    >
      <i class="text-sm fa-solid fa-users xl:mr-2"></i> 
      
        Utilisateurs
      
    </a>
    <a
      class="px-1 md:px-3 py-2 text-center xl:text-left rounded-md hover:bg-white hover:text-black transition ease-in duration-200 w-full {{chats_page}}"
      href="{% url 'chats' %}"
    >
      <i class="text-sm fa-solid fa-comments xl:mr-2"></i> 
      
        Messagerie
      
    </a>
    {% if user.is_superuser %}
    <a
    class="px-1 md:px-3 py-2 text-center xl:text-left rounded-md hover:bg-white hover:text-black transition ease-in duration-200 w-full {{report_page}}"
    href="{% url 'reports' %}"
    >
    <i class="fa-sharp fa-solid fa-file-lines xl:mr-2"></i> 
    
      Rapports
    
  </a>
  <a
    class="px-1 md:px-3 py-2 text-center xl:text-left rounded-md hover:bg-white hover:text-black transition ease-in duration-200 w-full {{params_page}}"
    href="{% url 'parameters' %}"
  >
    <i class="fa-solid fa-sliders xl:mr-2"></i> 
    
      Param√®tres
    
  </a>
  <a
    class="px-1 md:px-3 py-2 text-center xl:text-left rounded-md hover:bg-white hover:text-black transition ease-in duration-200 w-full {{dash_page}}"
    href="{% url 'dashboard' %}"
  >
    <i class="fa-sharp fa-solid fa-bars-progress xl:mr-2"></i> 
    
      Tableau de bord
    
  </a>
    {% endif %}
    <a
      class="px-1 md:px-3 py-2 text-center xl:text-left rounded-md hover:bg-white hover:text-black transition ease-in duration-200 w-full {{about_page}}"
      href="{% url 'about' %}"
    >
      <i class="text-sm fa-solid fa-circle-info xl:mr-2"></i> 
      
        A propos
      
    </a>


    {% if user.is_superuser %}
    <a
     target="_blank"
      class="px-1 md:px-3 py-2 text-center xl:text-left rounded-md hover:bg-red-900 hover:text-white transition ease-in duration-200 w-full"
      href="{% url 'admin:index' %}"
      ><i class="text-sm fa-solid fa-lock xl:mr-2"></i> <span class="hidden xl:inline ">
        Admin Dashboard</a
        >
      
    {% endif %}
 <div
      class="w-full px-1 py-2 xl:p-2 flex flex-col xl:flex-row items-center gap-1 xl:gap-2 mb-2 xl:bg-white sm:text-sm xl:text-md rounded-md cursor-pointer"
    >
    {% if not user.image %}
    <img
      class="hidden xl:inline h-10 w-10 rounded-md object-cover"
      src="{% static 'imgs/anon.png' %}"
      alt="welcome image"
    />
    {% else %}
    <img
      class="hidden xl:block h-10 w-10 rounded-md object-cover"
      src="{{user.image.url}}"
      alt="welcome image"
    />
    {% endif %}
      <div class="hidden xl:block w-full">
        <p class="text-black font-bold">{{user.last_name|title}} {{user.first_name|title}}</p>
        <p class="text-gray-500">@{{user.username}}</p>
      </div>
      <div class="relative">

        <button
          type="button"
          class="bg-white hover:bg-purple-200 hover:text-black px-4 py-2 rounded-md"
          name="dropdownBtn"
          id="dropdownBtn"
          aria-expanded="false"
          aria-haspopup="true"
          onclick="toggleDropdown(this)"
        >
          <i class="fa-sharp fa-solid fa-caret-down text-gray-700"></i>
      
        </button>
  
        <div
          class="mb-4 w-full xl:p-2 hidden absolute right-0 top-12 origin-top-left bg-white z-30 rounded-md xl:w-40 grid gap-2 overflow-hidden"
          role="menu"
          aria-orientation="vertical"
          aria-labelledby="user-menu-button"
          id="dropdownMenu"
        >
          <a href="{% url 'profile' user.id  %}"
            class="p-2 flex text-sm text-gray-700 hover:text-black hover:bg-purple-200 xl:rounded-md w-full"
            >
            <i class="text-sm fa-solid fa-user xl:mr-2"></i> 
            Mon Profile
            </a
          >
          <a
            hx-confirm="Voulez vous vraiment vous deconnecter?"
            href="{% url 'logout' %}"
            class="p-2 flex text-sm text-red-700 hover:bg-red-700 hover:text-white xl:rounded-md w-full"
            >
            <i class="text-sm fa-solid fa-right-from-bracket xl:mr-2"></i>
            Deconnexion
            </a
          >
        </div>
      </div>
    </div>
  </ul>
</div>

<style>
.sidebar {
  position: fixed;
  top: 0;
  left: -300px;
  width: 300px;
  height: 100%;
  /* background-color: #333;
  color: #fff;
  padding-top: 60px; */
  transition: left 0.3s ease;
  z-index: 10;
}


.main-content {
  flex: 1;
  padding: 20px;
}

.toggle-btn {
  position: fixed;
  top: 20px;
  left: 20px;
  background-color: #333;
  color: #fff;
  border: none;
  padding: 10px 20px;
  cursor: pointer;
}

.overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5); /* dark veil with 50% opacity */
  display: none;
  z-index: 1; /* Ensure overlay is behind the sidebar */
}

</style>

<script>
function toggleDropdown(e) {
  e.name === "dropdownBtn"
  ? ((e.name = "close"), dropdownMenu.classList.remove("hidden"))
  : ((e.name = "dropdownBtn"), dropdownMenu.classList.add("hidden"));
}

// --------------------------------------------------------------------

function toggleSidebar() {
  const sidebar = document.getElementById('sidebar_alt');
  const overlay = document.getElementById('overlay');
  if (sidebar.style.left === '-300px') {
    sidebar.style.left = '0';
    overlay.style.display = 'block';
  } else {
    sidebar.style.left = '-300px';
    overlay.style.display = 'none';
  }
}




window.addEventListener("mouseup", function (event) {
  dropdownMenu.classList.add("hidden");
});
</script>

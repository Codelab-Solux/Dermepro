{% extends 'main.html' %} {% load static %}

<!--  -->
{% block content %}
<div>
  <div
    class="p-6 bg-purple-50 border border-purple-300 rounded-lg flex flex-col md:flex-row gap-8 justify-between items-center"
  >
    <article class="w-5/7 max-w-[800px]">
      <h1 class="text-black text-3xl lg:text-7xl font-bold">Dermepro</h1>
      <p class="mt-4">
        Derme Pro, votre application de gestion des visiteurs est un outil qui
        permet de suivre et de contrôler les entrées et les sorties des
        visiteurs dans un bâtiment ou dans une zone spécifique.
      </p>
    </article>
  </div>

  <!----------------------------------------- status quo ----------------------------------------->

  <div class="mt-8 p-4 border rounded-lg">
    {% if user.role.sec_level >= 4 %}
    <h3 class="mb-4 text-black text-lg font-bold">Status Quo</h3>
    <div class="grid md:grid-cols-2 gap-4">
      <div class="grid">
        <h3>Hôtes non disponibles</h3>
        <div
          class="mt-2 w-full"
          hx-get="{% url 'unavailable_users' %}"
          hx-trigger="load, db_changed from:body"
          hx-target="this"
        ></div>
      </div>
      <div class="grid">
        <h3>Hôtes en réunion</h3>
        <div
          class="mt-2 w-full"
          hx-get="{% url 'occupied_users' %}"
          hx-trigger="load, db_changed from:body"
          hx-target="this"
        ></div>
      </div>
    </div>
    {% endif %}

    <!-------------------- ongoing appointments -------------------->
    <div
      class="w-full mt-4 ongoing_appointments"
      hx-get="{% url 'ongoing_appointments' %}"
      hx-trigger="load, db_changed from:body"
      hx-target="this"
    ></div>
    <!-------------------- ongoing visits -------------------->
    <div
      class="w-full mt-4 ongoing_visits"
      hx-get="{% url 'ongoing_visits' %}"
      hx-trigger="load, db_changed from:body"
      hx-target="this"
    ></div>
  </div>

  <!----------------------------------------- visits ----------------------------------------->

  <div class="mt-8 p-4 border rounded-lg">
    <!-- visits -->
    <div class="flex justify-between items-center">
      <h3 class="text-black text-xl font-bold">File d'attente des visites</h3>
      {% if user.role.sec_level >= 4 %}
      <button
        hx-target="#basic_dialog"
        hx-get="{% url 'create_visit' %}"
        class="w-fit px-3 py-2 bg-purple-200 text-sm hover:bg-purple-300 flex items-center rounded-md cursor-pointer transition duration-200 ease-in"
      >
        <span class="hidden md:inline mr-2">Nouvelle visite</span>
        <i class="fa-solid fa-plus"></i>
      </button>
      <!-- <a
        href="{#% url 'add_visit' %#}"
        class="w-fit px-3 py-2 bg-purple-100 text-sm hover:bg-purple-200 flex items-center rounded-lg cursor-pointer transition duration-200 ease-in"
      >
        <span class="hidden md:inline mr-2">Nouvelle visite</span>
        <i class="fa-solid fa-plus"></i>
      </a> -->
      {% endif %}
    </div>

    <!-- pending visits list -->
    <div
      class="my-4 flex flex-col md:flex-row justify-between md:items-center gap-8"
    >
      <img
        class="md:hidden lg:inline h-80 object-contain"
        src="{% static 'imgs/waiting.png' %}"
        alt="welcome image"
      />

      <div
        class="w-full pending_visits"
        hx-get="{% url 'pending_visits' %}"
        hx-trigger="load, db_changed from:body"
        hx-target="this"
      ></div>
    </div>
  </div>

  <!----------------------------------------- appointments ----------------------------------------->

  {% if user.role.sec_level >= 4 %}
  <div class="mt-8 p-4 border rounded-lg">
    <div class="flex justify-between items-center">
      <h3 class="text-black text-xl font-bold">
        File d'attente des rendez-vous
      </h3>
      <button
        hx-target="#basic_dialog"
        hx-get="{% url 'create_appointment' %}"
        class="w-fit px-3 py-2 bg-purple-200 text-sm hover:bg-purple-300 flex items-center rounded-md cursor-pointer transition duration-200 ease-in"
      >
        <span class="hidden md:inline mr-2">Nouveau rendez-vous</span>
        <i class="fa-solid fa-plus"></i>
      </button>
    </div>

    <!-- Appointments -->
    <div
      class="mt-4 w-full flex flex-col md:flex-row-reverse justify-between md:items-center"
    >
      <img
        class="md:hidden lg:inline h-80 object-cover"
        src="{% static 'imgs/schedule.png' %}"
        alt="welcome image"
      />
      <div class="w-full flex flex-col justify-between gap-4">
        <!-------------------- pending VIP appointments -------------------->
        <div
          class="w-full pending_vips"
          hx-get="{% url 'pending_vips' %}"
          hx-trigger="load, db_changed from:body"
          hx-target="this"
        ></div>
        <!-------------------- other pending appointments -------------------->
        <div class="bg-gray-50 p-4 rounded-lg">
          <div
            class="w-full pending_appointments"
            hx-get="{% url 'pending_appointments' %}"
            hx-trigger="load, db_changed from:body"
            hx-target="this"
          ></div>
        </div>
      </div>
    </div>
  </div>
  {% endif %}
</div>
{% endblock %}

<div class="relative text-gray-700">
  <button
    type="button"
    class="hover:text-black hover:bg-purple-50 px-4 py-2 rounded-lg"
    name="statusChanger"
    id="statusChanger"
    aria-expanded="false"
    aria-haspopup="true"
    onclick="toggleVisitStatusDropdown(this,'{{obj.id}}')"
  >
    <i class="fa-sharp fa-solid fa-ellipsis-vertical"></i>
  </button>

  <div
    class="hidden bg-purple-50 w-40 shadow-md lg:w-[180px] p-2 absolute right-0 top-12 origin-top-left bg-white z-10 rounded-lg flex flex-col items-center gap-2 text-xs lg:text-sm overflow-hidden"
    role="status menu"
    aria-orientation="vertical"
    aria-labelledby="status-menu-button"
    tabindex="-1"
    id="statusMenu{{obj.id}}"
  >
    <button
      hx-post="{% url 'edit_visit_status' obj.id 1  %}"
      hx-target=".obj_status{{obj.id}}, .visit_details"
      hx-swapp="innerHTML"
      class="p-2 flex items-center hover:text-black hover:bg-purple-200 rounded-md w-full text-center"
    >
      <i class="text-sm fa-solid fa-spinner mr-2"></i>
      Mettre en attente
    </button>
    <button
      hx-post="{% url 'edit_visit_status' obj.id 2 %}"
      hx-target=".obj_status{{obj.id}}, .visit_details"
      hx-swapp="innerHTML"
      class="p-2 flex items-center hover:text-black hover:bg-amber-200 rounded-md w-full text-center"
    >
      <i class="text-sm fa-solid fa-hourglass-half mr-2"></i>
      Mettre en cours
    </button>
    <button
      hx-post="{% url 'edit_visit_status' obj.id 3 %}"
      hx-target=".obj_status{{obj.id}}, .visit_details"
      hx-swapp="innerHTML"
      class="p-2 flex items-center hover:text-black hover:bg-green-200 rounded-md w-full text-center"
    >
      <i class="text-sm fa-solid fa-square-check mr-2"></i>
      Terminer
    </button>
    <button
      hx-post="{% url 'edit_visit_status' obj.id 4 %}"
      hx-target=".obj_status{{obj.id}}, .visit_details"
      hx-swapp="innerHTML"
      class="p-2 flex items-center hover:text-black hover:bg-sky-200 rounded-md w-full text-center"
    >
      <i class="text-sm fa-solid fa-rotate-right mr-2"></i>
      Reporter
    </button>
    <button
      hx-post="{% url 'edit_visit_status' obj.id 5 %}"
      hx-target=".obj_status{{obj.id}}, .visit_details"
      hx-swapp="innerHTML"
      class="p-2 flex items-center hover:text-black hover:bg-red-200 rounded-md w-full text-center"
    >
      <i class="text-sm fa-solid fa-ban mr-2"></i>
      Annuler
    </button>
  </div>
</div>
<script>
  function toggleVisitStatusDropdown(e, obj_id) {
    activeMenu = document.getElementById(`statusMenu${obj_id}`);
    e.name === `statusChanger`
      ? ((e.name = "close"), activeMenu.classList.remove("hidden"))
      : ((e.name = `statusChanger`), activeMenu.classList.add("hidden"));
  }

  window.addEventListener("mouseup", function (event) {
    activeMenu.classList.add("hidden");
  });
</script>
